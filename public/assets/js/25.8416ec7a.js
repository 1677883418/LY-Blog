(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{589:function(s,t,a){"use strict";a.r(t);var n=a(5),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"title"}),a("p",[s._v("难装的一批,吐了")])]),a("h1",{attrs:{id:"openstack部署"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#openstack部署"}},[s._v("#")]),s._v(" OpenStack部署")]),s._v(" "),a("h2",{attrs:{id:"部署配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#部署配置"}},[s._v("#")]),s._v(" 部署配置")]),s._v(" "),a("p",[s._v("服务器:ubuntu20.04-live-server")]),s._v(" "),a("p",[s._v("远控软件: mobaXterm")]),s._v(" "),a("h2",{attrs:{id:"部署注意点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#部署注意点"}},[s._v("#")]),s._v(" 部署注意点")]),s._v(" "),a("ul",[a("li",[s._v("截止"),a("em",[s._v("2022-5-17")]),s._v("时，devstack官方推荐版本仍然是ubuntu的上一个LTS版本20.04    "),a("strong",[s._v("头铁当然可以用22.04版本尝试，不过会遇到比如python版本过新导致无法使用devstack默认的管理方式等各种各样的迷惑问题")])]),s._v(" "),a("li",[s._v("如果能够接受命令行黑框框以及复制难的问题，那远控软件可以不要、")]),s._v(" "),a("li",[s._v("运行过程中会从apt源、github、python源等官方源获取文件,众所周知，国内访问极其容易超时或者直接访问不到，所以需要换源/反代\n"),a("ul",[a("li",[s._v("apt: 首先"),a("code",[s._v("sudo vim /etc/apt/sources.list")]),s._v(",然后修改里面类似"),a("code",[s._v("http://cn.ubuntu.com/ubuntu")]),s._v("之类的字样为"),a("code",[s._v("http://mirrors.aliyun.com/ubuntu")]),s._v(",然后即可换源成功")]),s._v(" "),a("li",[s._v("git:首先通过"),a("a",{attrs:{href:"http://ping.chinaz.com/github.com",target:"_blank",rel:"noopener noreferrer"}},[s._v("查询github IP 点我"),a("OutboundLink")],1),s._v("获取到不超时的ip地址，然后执行"),a("code",[s._v("sudo vim /etc/hosts")]),s._v("打开并编辑host文件，另起一行写"),a("code",[s._v("xxx.xxx.xxx.xxx github.com")]),s._v("其中"),a("code",[s._v("xxx.xxx.xxx.xxx")]),s._v("就是刚刚查询到的不超时的IP地址")]),s._v(" "),a("li",[s._v("python/pip:采用换源方法，在devstack目录下执行"),a("code",[s._v("pip config set global.index-url https://mirrors.aliyun.com/pypi/simple/")]),s._v("修改pip源为阿里源")])])])]),s._v(" "),a("h2",{attrs:{id:"部署过程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#部署过程"}},[s._v("#")]),s._v(" 部署过程")]),s._v(" "),a("p",[s._v("首先安装pip3")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" python3-pip\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("本文大部分内容参阅官方文档，"),a("a",{attrs:{href:"https://docs.openstack.org/devstack/latest/",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方文档点我"),a("OutboundLink")],1),s._v("\n首先添加新用户\n"),a("code",[s._v("sudo useradd -s /bin/bash -d /opt/stack -m stack")]),s._v("\n添加新用户后要更改权限")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/sudoers\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#添加下面这行在root行下")]),s._v("\nstack "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ALL")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ALL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" NOPASSWD: ALL\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("保存后退出，使用"),a("code",[s._v("sudo -u stack -i")]),s._v("命令登入"),a("code",[s._v("stack")]),s._v("用户\n获取官方devstack脚本")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#如果git提示time out或者别的，请参阅 部署注意点 的github换源教程")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" clone https://opendev.org/openstack/devstack\n$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" devstack\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("目前应该处于devstack目录下，使用"),a("code",[s._v("sudo vim local.conf")]),s._v("创建local.conf文件并配置默认密码")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("local"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("localrc"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# use TryStack git mirror")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("GIT_BASE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("http://git.trystack.cn\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("NOVNC_REPO")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("http://git.trystack.cn/kanaka/noVNC.git\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("SPICE_REPO")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("http://git.trystack.cn/git/spice/spice-html5.git\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Define images to be automatically downloaded during the DevStack built process.")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#DOWNLOAD_DEFAULT_IMAGES=False")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#IMAGE_URLS="http://download.cirros-cloud.net/0.3.4/cirros-0.3.4-x86_64-disk.img"')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Misc")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ADMIN_PASSWORD")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("admin\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("DATABASE_PASSWORD")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ADMIN_PASSWORD")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("RABBIT_PASSWORD")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ADMIN_PASSWORD")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("SERVICE_PASSWORD")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ADMIN_PASSWORD")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("SERVICE_TOKEN")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ADMIN_PASSWORD")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Target Path")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#DEST=/opt/stack")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br")])]),a("p",[s._v("运行安装脚本\n"),a("code",[s._v("FORCE=yes ./stack.sh")]),s._v("\n然后就可以开始漫长的等待了，总时长大概需要2小时左右，安装过程中可能提示"),a("code",[s._v("python.org")]),s._v("和"),a("code",[s._v("time out")]),s._v("之类的字样，那就说明连接超时了，请参阅部署注意点中的"),a("em",[s._v("pip换源")])])])}),[],!1,null,null,null);t.default=e.exports}}]);